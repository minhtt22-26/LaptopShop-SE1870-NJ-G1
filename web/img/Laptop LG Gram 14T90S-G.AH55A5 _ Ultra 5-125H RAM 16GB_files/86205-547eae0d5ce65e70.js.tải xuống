"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86205],{56026:function(e,t,o){o.d(t,{p:function(){return i}});var n=o(4334);let i=e=>(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M20.25 6.74977H18.4537C18.6345 6.39247 18.7356 6.00019 18.75 5.60002C18.724 4.89259 18.4212 4.22367 17.9068 3.73733C17.3924 3.25098 16.7075 2.98612 15.9998 2.99977C15.1567 3.03608 14.3393 3.30064 13.6349 3.7652C12.9305 4.22976 12.3654 4.8769 12 5.63752C11.6385 4.87902 11.0778 4.23298 10.3776 3.76839C9.67753 3.30381 8.86436 3.03814 8.025 2.99977H7.9395C7.24185 3.00089 6.5718 3.27246 6.07024 3.75738C5.56867 4.2423 5.27465 4.9028 5.25 5.60002V5.64952C5.26463 6.03243 5.36158 6.40769 5.53425 6.74977H3.75C3.55109 6.74977 3.36032 6.82879 3.21967 6.96944C3.07902 7.11009 3 7.30086 3 7.49977V9.74977C3 9.94868 3.07902 10.1394 3.21967 10.2801C3.36032 10.4208 3.55109 10.4998 3.75 10.4998H20.25C20.4489 10.4998 20.6397 10.4208 20.7803 10.2801C20.921 10.1394 21 9.94868 21 9.74977V7.49977C21 7.30086 20.921 7.11009 20.7803 6.96944C20.6397 6.82879 20.4489 6.74977 20.25 6.74977ZM16.023 4.49977C16.3293 4.49182 16.6271 4.60137 16.8552 4.80595C17.0834 5.01053 17.2246 5.29464 17.25 5.60002C17.2394 5.90701 17.1105 6.19802 16.8904 6.41227C16.6703 6.62652 16.3759 6.74744 16.0687 6.74977H13.1085C13.575 5.80552 14.5028 4.49977 16.023 4.49977ZM6.75 5.62477C6.7692 5.31786 6.90549 5.03004 7.13074 4.8207C7.35599 4.61136 7.65301 4.49648 7.9605 4.49977C9.51225 4.50577 10.4213 5.79802 10.893 6.74977H7.968C7.66005 6.75209 7.36276 6.63709 7.13653 6.42813C6.9103 6.21918 6.7721 5.93194 6.75 5.62477ZM13.5 11.9999V20.9999H17.25C17.8467 20.9999 18.419 20.7629 18.841 20.3409C19.2629 19.919 19.5 19.3467 19.5 18.7499V11.9999H13.5ZM4.49999 11.9999H10.5V20.9999H6.74999C6.15325 20.9999 5.58096 20.7629 5.159 20.3409C4.73704 19.919 4.49999 19.3467 4.49999 18.7499V11.9999Z",fill:"#A7ABC3"}}]})(e)},78549:function(e,t,o){o.d(t,{$:function(){return i}});var n=o(4334);let i=e=>(0,n.w_)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M14.563 20C14.785 19.1374 15.5681 18.5 16.5 18.5C17.4319 18.5 18.215 19.1374 18.437 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4H18.437C18.215 4.86261 17.4319 5.5 16.5 5.5C15.5681 5.5 14.785 4.86261 14.563 4L4 4C2.89543 4 2 4.89543 2 6L2 18C2 19.1046 2.89543 20 4 20H14.563ZM10.3057 13.6328C10.3057 13.3757 10.2422 13.1738 10.1152 13.0273C9.98828 12.8809 9.7653 12.7425 9.44629 12.6123C9.12728 12.4821 8.83268 12.3503 8.5625 12.2168C8.29232 12.0833 8.05957 11.9287 7.86426 11.7529C7.66895 11.5771 7.51921 11.3737 7.41504 11.1426C7.31087 10.9115 7.25879 10.6315 7.25879 10.3027C7.25879 9.7526 7.44434 9.30013 7.81543 8.94531C8.18652 8.58724 8.68131 8.37891 9.2998 8.32031V7.29004H10.0762V8.33984C10.6719 8.42773 11.139 8.6735 11.4775 9.07715C11.8193 9.47754 11.9902 9.98698 11.9902 10.6055H10.3398C10.3398 10.2669 10.2747 10.0065 10.1445 9.82422C10.0143 9.64193 9.82878 9.55078 9.58789 9.55078C9.37305 9.55078 9.2054 9.61914 9.08496 9.75586C8.96777 9.88932 8.90918 10.0749 8.90918 10.3125C8.90918 10.5534 8.97754 10.7454 9.11426 10.8887C9.25098 11.0286 9.4707 11.1637 9.77344 11.2939C10.0762 11.4209 10.361 11.5544 10.6279 11.6943C10.8981 11.8311 11.1309 11.9873 11.3262 12.1631C11.5215 12.3389 11.6745 12.5439 11.7852 12.7783C11.8958 13.0127 11.9512 13.2943 11.9512 13.623C11.9512 14.1797 11.7738 14.6338 11.4189 14.9854C11.0674 15.3369 10.5872 15.542 9.97852 15.6006V16.582H9.20215V15.5957C8.49251 15.5208 7.94727 15.2783 7.56641 14.8682C7.1888 14.4548 7 13.9111 7 13.2373H8.64551C8.64551 13.6084 8.72689 13.8916 8.88965 14.0869C9.05566 14.279 9.29004 14.375 9.59277 14.375C9.81413 14.375 9.98828 14.3099 10.1152 14.1797C10.2422 14.0462 10.3057 13.8639 10.3057 13.6328ZM17.2002 16.4C17.2002 16.7314 16.9316 17 16.6002 17C16.2688 17 16.0002 16.7314 16.0002 16.4V15.52C16.0002 15.1886 16.2688 14.92 16.6002 14.92C16.9316 14.92 17.2002 15.1886 17.2002 15.52V16.4ZM17.2002 12.88C17.2002 13.2114 16.9316 13.48 16.6002 13.48C16.2688 13.48 16.0002 13.2114 16.0002 12.88L16.0002 11.12C16.0002 10.7886 16.2688 10.52 16.6002 10.52C16.9316 10.52 17.2002 10.7886 17.2002 11.12V12.88ZM17.2002 8.48C17.2002 8.81137 16.9316 9.08 16.6002 9.08C16.2688 9.08 16.0002 8.81137 16.0002 8.48V7.6C16.0002 7.26863 16.2688 7 16.6002 7C16.9316 7 17.2002 7.26863 17.2002 7.6V8.48Z",fill:"#82869E"}}]})(e)},65396:function(e,t,o){o.d(t,{$:function(){return a}});var n=o(26533),i=o(91987),l=o(67318);let r=n.z.div``,u=n.z.div`
  display: flex;
  flex-wrap: wrap;
  overflow-y: hidden;
  overflow-x: auto;
`,c=n.z.div`
  font-family: Roboto, sans-serif;
  font-weight: 500;
  font-size: 10px;
  line-height: 16px;
  color: #82869e;
  margin-bottom: 4px;
  text-transform: uppercase;
`,a=({configuration:e,onSelectVariant:t,index:o,className:n})=>{let a=e.options.find(e=>e.selected);return i.createElement(r,{className:n},i.createElement(c,null,e.name,a?`: ${a.value}`:""),i.createElement(u,null,e.options.map(e=>i.createElement(l.D,{key:e.optionId,option:e,onSelectVariant:t,index:o}))))}},67318:function(e,t,o){o.d(t,{D:function(){return c}});var n=o(91987),i=o(26533),l=o(17102);let r=i.z.div(({isThumbnail:e,theme:t,isVisible:o,isActive:n})=>`
    width: ${e?"32px":"fit-content"};
    height: ${e?"32px":"fit-content"};
    border: 1px ${n?t.brand.primary:"#e0e0e0"} solid;
    position: relative;
    border-radius: 4px;

    margin: 0 8px 12px 0;
    padding: ${e?"4px":"8px 16px"};
    color: 'black';
    background-color: ${o||n?"#fff":"#e0e0e0"};
    text-transform: capitalize;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: ${o||n?"pointer":"not-allowed"};
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 4px;
    }
`),u=i.z.span``,c=({option:e,index:t,onSelectVariant:o})=>n.createElement(r,{isActive:e.selected,isVisible:e.visible,onClick:()=>o(e,t),isThumbnail:!!e.thumbnailUrl},e.thumbnailUrl?n.createElement(n.Fragment,null,n.createElement(l.w,{src:e.thumbnailUrl})):n.createElement(u,null,e.value))},73137:function(e,t,o){o.d(t,{Mo:function(){return h}});var n=o(61261),i=o(56026),l=o(78549),r=o(19077),u=o(26533),c=o(34655),a=o(91987);function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function v(){let e=s(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n"]);return v=function(){return e},e}function p(){let e=s(["\n  display: flex;\n  justify-content: space-between;\n  margin-top: 8px;\n"]);return p=function(){return e},e}let f=(e,t,o)=>{if("percent"===e.discountType)return(0,n.jsxs)(n.Fragment,{children:[(0,c.t)("Giảm")," ",e.percent,"%",!!e.maxDiscount&&(0,n.jsxs)(n.Fragment,{children:[" ",(0,c.t)("tối đa")," ",(0,n.jsx)(r.F,{value:e.maxDiscount||0})]})]});let i=o||(0,c.t)("sản phẩm");return(0,n.jsxs)(n.Fragment,{children:[(0,c.t)("Giảm")," ",(0,n.jsx)(r.F,{value:e.money||0})," / ".concat(t>1?t:"")," ".concat(i)]})},m=e=>{var t,o;let{benefit:r={}}=e||{},u=(null===(t=r.money)||void 0===t?void 0:t.length)||(null===(o=r.items)||void 0===o?void 0:o.length);return u?(0,n.jsx)(i.p,{color:"primary500",size:32}):(0,n.jsx)(l.$,{color:"primary500",size:32})},b=(e,t,o)=>{var i,l,r;let{benefit:u={}}=e||{},d=[];(null===(i=u.money)||void 0===i?void 0:i.length)&&d.push(f(u.money[0],t,o));let s="".concat(d.length?(0,c.t)("Tặng").toLowerCase():(0,c.t)("Tặng")," ");if(null===(l=u.items)||void 0===l?void 0:l.length){let v=s;s="",u.items.forEach(e=>{let{quantity:t,name:o}=e;v+="".concat(t,"x ").concat(o,", ")}),d.push(v.substr(0,v.length-2))}if(null===(r=u.voucher)||void 0===r?void 0:r.name){let{voucher:p}=u;d.push("".concat(s).concat(p.quantity,"x ").concat(p.name))}let m=d.length;return(0,n.jsx)(n.Fragment,{children:d.map((e,t)=>(0,n.jsxs)(a.Fragment,{children:[e,t!==m-1&&", "]},t))})},g=(e,t)=>e?(0,c.t)("Khi mua từ {{quantity}} {{productUnitName}} trở l\xean",{quantity:e,productUnitName:t||(0,c.t)("sản phẩm")}):null,h=e=>{var t,o,{promotion:i,className:l,active:r=!1,onClick:u,productUnitName:a=""}=e,s=function(e,t){if(null==e)return{};var o,n,i=function(e,t){if(null==e)return{};var o,n,i={},l=Object.keys(e);for(n=0;n<l.length;n++)o=l[n],t.indexOf(o)>=0||(i[o]=e[o]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)o=l[n],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(e,["promotion","className","active","onClick","productUnitName"]);return(0,n.jsxs)(C,(t=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(t){d(e,t,o[t])})}return e}({className:l,isActive:r,onClick:()=>u(i.id)},s),o=(o={children:[(0,n.jsx)(y,{children:m(i)}),(()=>{var e,t;let o=(null==i?void 0:null===(e=i.condition)||void 0===e?void 0:e.blockSizeDecimal)||0,l=(null==i?void 0:null===(t=i.condition)||void 0===t?void 0:t.minQuantityDecimal)||0,u=g(l,a);return(0,n.jsxs)(P,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{active:r,children:b(i,o,a)}),u&&(0,n.jsx)(w,{children:u})]}),(0,n.jsxs)(j,{children:[i.endedAt?(0,n.jsx)(S,{children:"".concat((0,c.t)("HSD"),": ").concat(new Date(i.endedAt).toLocaleDateString("vi"))}):null,(0,n.jsx)(k,{children:r?(0,c.t)("Bỏ chọn"):(0,c.t)("\xc1p dụng")})]})]})})()]},o),Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):(function(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o.push.apply(o,n)}return o})(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}),t))},C=u.z.div(e=>{let{isActive:t,theme:o}=e;return"\n    width: 100%;\n    display: flex;\n    margin-top: 10px;\n    padding: 12px;\n    border-radius: 8px;\n  \n    background-color: ".concat(t?null==o?void 0:o.colors.primary50:"#ffffff",";\n    border: 1px solid ").concat(t?null==o?void 0:o.colors.primary500:"#E4E5F0",";\n    cursor: pointer;\n  ")}),y=u.z.div(e=>{let{theme:t}=e;return"\n  height: 64px;\n  width: 64px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-right: 12px;\n  border-radius: 4px;\n  background-color: ".concat(null==t?void 0:t.colors.primary100,";\n")}),P=u.z.div(v()),x=e=>"\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: ".concat(e,";\n  "),O=u.z.div(e=>{let{active:t,theme:o}=e;return"\n      font-size: 13px;\n      font-weight: 500;\n      line-height: 20px;\n      ".concat(x(2),"\n      color: ").concat(t?"#1B1D29":null==o?void 0:o.colors.text,";\n    ")}),w=u.z.div(e=>{let{theme:t}=e;return"\n    margin-top: 4px;\n    font-size: 12px;\n    line-height: 16px;\n    color: ".concat(null==t?void 0:t.colors.neutral,";\n    ").concat(x(2),"\n  ")}),j=u.z.div(p()),S=u.z.div(e=>{let{theme:t}=e;return"\n      font-size: 12px;\n      line-height: 16px;\n      color: ".concat(null==t?void 0:t.colors.neutral,";\n    ")}),k=u.z.div(e=>{let{theme:t}=e;return"\n      font-size: 13px;\n      line-height: 20px;\n      color: ".concat(null==t?void 0:t.colors.link500,";\n    ")})},54068:function(e,t,o){o.d(t,{Hz:function(){return b},JC:function(){return p},zX:function(){return m}});var n=o(84443),i=o(43015),l=o(60295),r=o(91987),u=o(59676),c=o(88837),a=o(27250);function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(t){d(e,t,o[t])})}return e}function v(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o.push.apply(o,n)}return o})(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}),e}let p=(e,t)=>{let{0:o,1:a}=(0,r.useState)([]),{0:d,1:p}=(0,r.useState)(t),{0:f,1:m}=(0,r.useState)(),{0:b,1:g}=(0,r.useState)(),{0:h,1:C}=(0,r.useState)(),y=((null==d?void 0:d.comboLineItems)||[]).map(e=>e.sku),{location:P}=(0,n.Wx)(),{discoveryService:x}=(0,i.Su)(),O=()=>Promise.all(y.map(e=>x.getProduct({sku:e,location:P}))),{data:w,error:j}=(0,u.ZP)("autogen"===e&&(null==y?void 0:y.length)?["".concat(x.getBaseUrl,"/list-product"),JSON.stringify(y)]:null,O,{revalidateOnFocus:!1}),{result:{combo:S},isLoading:k}=(0,c.lR)(d,"dynamic"===e),N=e=>{g(e.reduce((e,t)=>e+(t.quantity||0)*t.supplierRetailPrice,0)),C(e.reduce((e,t)=>e+(t.quantity||0)*t.latestPrice,0))},I=(t,n)=>{if("autogen"===e){let i=o.map(e=>e.sku===t?v(s({},e),{quantity:n}):e);a(i),N(i)}},E=(e,t)=>{let n=o.map((o,n)=>e===n?t:o);a(n),p({comboLineItems:n.map(e=>({sku:e.sku,sellerSku:e.sellerSku,quantity:e.quantity,selectPromotionId:e.selectionPromotionId}))}),N(n)},z=e=>{p(e)},V=()=>{if(!w)return;let e=w.map(e=>{var t,o,n,i,r,u,c,a,s,v,p,f;let m=e.productInfo.sku,b=(null===(t=d.comboLineItems.find(e=>e.sku===m))||void 0===t?void 0:t.quantity)||1,g=(0,l.NP)(e),h=null==g?void 0:null===(o=g.selectionPromotions)||void 0===o?void 0:o[0],C=[],y=[];return(e.defaultPromotions||[]).forEach(e=>{var t,o,n,i;(null==e?void 0:null===(t=e.benefit)||void 0===t?void 0:null===(o=t.gifts)||void 0===o?void 0:o.length)&&(C=[...C,...e.benefit.gifts]),(null==e?void 0:null===(n=e.benefit)||void 0===n?void 0:null===(i=n.voucher)||void 0===i?void 0:i.name)&&y.push(e.benefit.voucher)}),h&&((null==h?void 0:null===(s=h.benefit)||void 0===s?void 0:null===(v=s.gifts)||void 0===v?void 0:v.length)&&(C=[...C,...h.benefit.gifts]),(null==h?void 0:null===(p=h.benefit)||void 0===p?void 0:null===(f=p.voucher)||void 0===f?void 0:f.name)&&y.push(h.benefit.voucher)),{sku:m,quantity:b,image:e.productInfo.imageUrl,name:e.productInfo.name,selectedVariant:(g.selected||[]).map(e=>e.value),supplierRetailPrice:Number(null==e?void 0:null===(n=e.prices)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:i.supplierRetailPrice)||0,latestPrice:Number(null==e?void 0:null===(r=e.prices)||void 0===r?void 0:null===(u=r[0])||void 0===u?void 0:u.latestPrice)||0,selectionPromotionId:null==h?void 0:h.id,defaultPromotions:(null==g?void 0:g.defaultPromotions)||[],selectionPromotion:h,selectionPromotions:(null==g?void 0:g.selectionPromotions)||[],allowSelectPromotion:(null==g?void 0:null===(c=g.selectionPromotions)||void 0===c?void 0:c.length)&&(null==g?void 0:null===(a=g.selectionPromotions)||void 0===a?void 0:a.length)>0,totalAvailable:e.totalAvailable,gifts:C,vouchers:y}});a(e),N(e)},D=()=>{if(!S)return;let e=S.products.map(e=>{var t,o,n,i,r,u;let c=null==e?void 0:e.product.productInfo.sku,a=null==e?void 0:e.product.productInfo.sellerSku,d=null==e?void 0:e.quantity,s=(null==e?void 0:e.product)?(0,l.NP)(null==e?void 0:e.product):null,v=[],p=[];return((null==e?void 0:e.product.promotions)||[]).forEach(e=>{var t,o,n,i;(null==e?void 0:null===(t=e.benefit)||void 0===t?void 0:null===(o=t.gifts)||void 0===o?void 0:o.length)&&(v=[...v,...e.benefit.gifts]),(null==e?void 0:null===(n=e.benefit)||void 0===n?void 0:null===(i=n.voucher)||void 0===i?void 0:i.name)&&p.push(e.benefit.voucher)}),{sku:c,sellerSku:a,quantity:d,image:null==e?void 0:e.product.productInfo.imageUrl,name:null==e?void 0:e.product.productInfo.name,selectedVariant:((null==s?void 0:s.selected)||[]).map(e=>e.value),supplierRetailPrice:Number(null==e?void 0:null===(t=e.product)||void 0===t?void 0:null===(o=t.prices)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.supplierRetailPrice)||0,latestPrice:Number(null==e?void 0:null===(i=e.product)||void 0===i?void 0:null===(r=i.prices)||void 0===r?void 0:null===(u=r[0])||void 0===u?void 0:u.latestPrice)||0,defaultPromotions:(null==e?void 0:e.product.promotions)||[],selectionPromotion:null,selectionPromotions:[],allowSelectPromotion:!1,totalAvailable:null==e?void 0:e.product.totalAvailable,gifts:v,vouchers:p}});m(v(s({},S.promotion),{id:S.id})),a(e),g(Number(S.supplierRetailPrice)||0),C(Number(S.latestPrice)||0)},H=t=>{t(e,d)},R=()=>"autogen"===e?V():D();return(0,r.useEffect)(()=>{p(t)},[JSON.stringify(t)]),(0,r.useEffect)(()=>{R()},[JSON.stringify(w),JSON.stringify(S)]),{payloadCombo:d,products:o,latestPrice:h,supplierRetailPrice:b,onChangeQuantity:I,comboPromotion:f,onChangeAutogenProduct:E,onChangeDynamicProduct:z,onFinish:H,loadingCombo:"autogen"===e?!j&&!w:k}},f=(e,t,o)=>{let{terminal:l}=(0,n.Wx)(),{cartServiceV2:r}=(0,i.Su)(),{data:c}=(0,u.ZP)(e&&l?["cart_service/calculate_price",e,l,o]:null,async(e,t,o)=>await r.calculatePrice({sku:t,selectPromotionId:o}),{revalidateOnFocus:!1}),{data:{saveWithoutSelectionPromotion:a,priceWithoutSelectionPromotion:d}={}}=(0,u.ZP)(e&&l?["cart_service/calculate_save_without_selection_promotion",e,l,]:null,async(e,o)=>{let{price:n}=await r.calculatePrice({sku:o,selectPromotionId:void 0});return isNaN(+t)||isNaN(+n)?{saveWithoutSelectionPromotion:void 0,priceWithoutSelectionPromotion:void 0}:{saveWithoutSelectionPromotion:+t-n,priceWithoutSelectionPromotion:n}},{revalidateOnFocus:!1});return{latestPrice:null==c?void 0:c.price,saveWithoutSelectionPromotion:a,priceWithoutSelectionPromotion:d}},m=(e,t)=>{let{0:o,1:n}=(0,r.useState)(t.sku),{0:i,1:u}=(0,r.useState)(t.selectionPromotionId),{0:a,1:d}=(0,r.useState)(t.quantity),{0:s,1:v}=(0,r.useState)(),{result:{product:p},isLoading:m}=(0,c.uD)(o),{latestPrice:b,priceWithoutSelectionPromotion:h,saveWithoutSelectionPromotion:C}=f(null==t?void 0:t.sku,null==t?void 0:t.supplierRetailPrice,i),y=(e,t)=>{let o=g(p,e,t);o&&n(o)};(0,r.useEffect)(()=>{var e,t,n;if(!p||!b)return;let r=(0,l.NP)(p),u=((null==r?void 0:r.selectionPromotions)||[]).find(e=>e.id===i)||null,c=[],d=[];(p.defaultPromotions||[]).forEach(e=>{var t,o,n,i;(null==e?void 0:null===(t=e.benefit)||void 0===t?void 0:null===(o=t.gifts)||void 0===o?void 0:o.length)&&(c=[...c,...e.benefit.gifts]),(null==e?void 0:null===(n=e.benefit)||void 0===n?void 0:null===(i=n.voucher)||void 0===i?void 0:i.name)&&d.push(e.benefit.voucher)});let s={sku:o,sellerSku:p.productInfo.sellerSku,quantity:a,image:p.productInfo.imageUrl,name:p.productInfo.name,selectedVariant:(r.selected||[]).map(e=>e.value),supplierRetailPrice:Number(null==p?void 0:null===(e=p.prices)||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.supplierRetailPrice)||0,latestPrice:b,selectionPromotionId:i,defaultPromotions:(null==r?void 0:r.defaultPromotions)||[],selectionPromotion:u,selectionPromotions:(null==r?void 0:r.selectionPromotions)||[],allowSelectPromotion:!0,totalAvailable:p.totalAvailable,gifts:c,vouchers:d,saveWithoutSelectionPromotion:C,productConfigurations:null==r?void 0:null===(n=r.productGroup)||void 0===n?void 0:n.configurations,priceWithoutSelectionPromotion:h,uomName:r.uomName||""};v(s)},[JSON.stringify(p),i,a,b,C,h,]);let P=t=>{s&&t(e,s)};return{product:s,onChangeVariant:y,onChangeQuantity:d,onChangeSelectionPromotionId:u,onFinish:P,loading:m,selectionPromotionId:i}},b=e=>{let{payload:t,selectedProductIdx:o}=e,{0:n,1:i}=(0,r.useState)(t),{result:{combo:u},isLoading:a}=(0,c.lR)(n,!0),{0:d,1:v}=(0,r.useState)(),p=(e,t)=>{var l;let r=null===(l=null==u?void 0:u.products[o])||void 0===l?void 0:l.product;if(!r)return;let c=g(r,e,t);if(c){let a=s({},n);a.comboLineItems=n.comboLineItems.map((e,t)=>o===t?{sku:c,sellerSku:e.sellerSku,quantity:e.quantity}:e),i(a)}},f=e=>{e(n)};return(0,r.useEffect)(()=>{var e,t,n,i,r;if(!u)return;let c=u.products[o];if(!c)return;let a=c.product,d=(0,l.NP)(a),s=[],p=[];(a.defaultPromotions||[]).forEach(e=>{var t,o,n,i;(null==e?void 0:null===(t=e.benefit)||void 0===t?void 0:null===(o=t.gifts)||void 0===o?void 0:o.length)&&(s=[...s,...e.benefit.gifts]),(null==e?void 0:null===(n=e.benefit)||void 0===n?void 0:null===(i=n.voucher)||void 0===i?void 0:i.name)&&p.push(e.benefit.voucher)});let f=Number(null==a?void 0:null===(e=a.prices)||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.supplierRetailPrice)||0,m=Number(null==a?void 0:null===(n=a.prices)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:i.latestPrice)||0,b={sku:a.productInfo.sku,sellerSku:a.productInfo.sellerSku,quantity:c.quantity,image:a.productInfo.imageUrl,name:a.productInfo.name,selectedVariant:(d.selected||[]).map(e=>e.value),supplierRetailPrice:f,latestPrice:m,defaultPromotions:(null==a?void 0:a.promotions)||[],selectionPromotion:null,selectionPromotions:[],allowSelectPromotion:!1,totalAvailable:a.totalAvailable,gifts:s,vouchers:p,saveWithoutSelectionPromotion:f-m,productConfigurations:null===(r=d.productGroup)||void 0===r?void 0:r.configurations,uomName:d.uomName||""};v(b)},[JSON.stringify(u),o]),{product:d,onChangeVariant:p,onFinish:f,loading:a}},g=(e,t,o)=>{var n,i,r,u,c,d,s,v;let p=(0,l.NP)(e);if(!(null==p?void 0:null===(n=p.selected)||void 0===n?void 0:n.length))return;let f=[],m="number"==typeof t.optionId?t.optionId:(0,a.C)(t.optionId,0),b={code:(null===(i=p.productGroup)||void 0===i?void 0:null===(r=i.configurations)||void 0===r?void 0:r[o].code)||"",value:t.value,id:m,optionId:m};for(let g=0;g<((null==p?void 0:null===(u=p.productGroup)||void 0===u?void 0:null===(c=u.configurations)||void 0===c?void 0:c.length)||0);g++)(null===(v=p.selected[g])||void 0===v?void 0:v.code)===b.code?f.push(b):f.push(p.selected[g]);if(!f.length)return;let h=0,C="";if(null===(d=p.productGroup)||void 0===d||null===(s=d.variants)||void 0===s||s.forEach(e=>{let t=0;for(let o=0;o<e.attributeValues.length;o++){var n,i;if((null===(n=e.attributeValues[o])||void 0===n?void 0:n.optionId)===(null===(i=f[o])||void 0===i?void 0:i.optionId))t++;else break}t>h&&(h=t,C=e.sku)}),C&&C!==p.sku)return C}},27250:function(e,t,o){o.d(t,{C:function(){return i},Q:function(){return n}});let n=e=>Number(e)===e&&e%1!=0,i=(e,t)=>{try{return Number.parseInt(e)}catch(o){return t||void 0}}}}]);